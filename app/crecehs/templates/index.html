{% extends 'base.html' %}

{% block content %}
<div class="container mx-auto p-6">
  <h1 class="text-4xl font-bold mb-6">Crecehs - Gestión de Cursos</h1>

  <!-- Pestañas -->
  <ul class="flex border-b mb-6" id="tabs">
    <li class="-mb-px mr-1">
      <a class="tab-link bg-white inline-block border-l border-t border-r rounded-t py-2 px-4 text-blue-700 font-semibold active" href="#tab-categorias">Categorías</a>
    </li>
    <li class="-mb-px mr-1">
      <a class="tab-link bg-white inline-block border-l border-t border-r rounded-t py-2 px-4 text-blue-700 font-semibold" href="#tab-cursos">Cursos</a>
    </li>
  </ul>

  <!-- Contenido de las pestañas -->
  <div id="tab-categorias" class="tab-content">
    <h2 class="text-2xl font-semibold mb-4">Categorías</h2>
    <button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg mb-4" data-modal-target="#modalAgregarCategoria">+ Agregar Categoría</button>
    <ul class="space-y-4">
      <!-- Aquí se listarán las categorías dinámicamente -->
      <li class="border rounded-lg p-4 hover:shadow-md">
        <h3 class="text-xl font-semibold">Ejemplo de Categoría</h3>
        <p class="text-gray-600">Descripción de la categoría.</p>
      </li>
    </ul>
  </div>

  <div id="tab-cursos" class="tab-content hidden">
    <h2 class="text-2xl font-semibold mb-4">Cursos</h2>
    <a href="{{ url_for('cursos.agregar_curso') }}"
   class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg mb-4 inline-block text-center">
    + Agregar Curso
    </a>
    <ul class="space-y-4">
      <!-- Aquí se listarán los cursos dinámicamente -->
      <li class="border rounded-lg p-4 hover:shadow-md">
        <h3 class="text-xl font-semibold">Ejemplo de Curso</h3>
        <p class="text-gray-600">Descripción del curso.</p>
      </li>
    </ul>
  </div>

  <!-- Modales -->
  <div id="modalAgregarCategoria" class="hidden fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center">
    <div class="bg-white rounded-lg shadow-lg p-6 w-1/3">
      <h2 class="text-xl font-bold mb-4">Agregar Categoría</h2>
      <form>
        <div class="mb-4">
          <label for="nombreCategoria" class="block text-sm font-medium text-gray-700">Nombre</label>
          <input type="text" id="nombreCategoria" class="mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
        </div>
        <div class="mb-4">
          <label for="descripcionCategoria" class="block text-sm font-medium text-gray-700">Descripción</label>
          <textarea id="descripcionCategoria" class="mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"></textarea>
        </div>
        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">Guardar</button>
        <button type="button" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg" onclick="closeModal('#modalAgregarCategoria')">Cancelar</button>
      </form>
    </div>
  </div>

  <!-- Modal de Agregar Curso -->
  <div id="modalAgregarCurso" class="hidden fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center">
    <div class="bg-white rounded-lg shadow-lg p-6 w-1/3">
      <h2 class="text-xl font-bold mb-4">Agregar Curso</h2>
      <!-- <form>
        <div class="mb-4">
          <label for="nombreCurso" class="block text-sm font-medium text-gray-700">Nombre</label>
          <input type="text" id="nombreCurso" class="mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
        </div>
        <div class="mb-4">
          <label for="descripcionCurso" class="block text-sm font-medium text-gray-700">Descripción</label>
          <textarea id="descripcionCurso" class="mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"></textarea>
        </div>
        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">Guardar</button>
        <button type="button" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg" onclick="closeModal('#modalAgregarCurso')">Cancelar</button>
      </form> -->
    </div>
  </div>
</div>

<script>
  document.querySelectorAll('.tab-link').forEach(link => {
    link.addEventListener('click', e => {
      e.preventDefault();
      document.querySelectorAll('.tab-link').forEach(l => l.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
      link.classList.add('active');
      document.querySelector(link.getAttribute('href')).classList.remove('hidden');
    });
  });

  document.querySelectorAll('[data-modal-target]').forEach(button => {
    button.addEventListener('click', () => {
      const modal = document.querySelector(button.getAttribute('data-modal-target'));
      modal.classList.remove('hidden');
    });
  });

  function closeModal(modalId) {
    const modal = document.querySelector(modalId);
    modal.classList.add('hidden');
  }

  async function fetchCategorias() {
    const response = await fetch('/crecehs/categorias');
    const categorias = await response.json();
    const categoriasList = document.querySelector('#tab-categorias ul');
    categoriasList.innerHTML = '';
    categorias.forEach(categoria => {
      const li = document.createElement('li');
      li.className = 'border rounded-lg p-4 hover:shadow-md';
      li.innerHTML = `<h3 class="text-xl font-semibold">${categoria.nombre}</h3>`;
      categoriasList.appendChild(li);
    });
  }

  async function fetchCursos(categoriaId) {
    const response = await fetch(`/crecehs/cursos/${categoriaId}`);
    const cursos = await response.json();
    const cursosList = document.querySelector('#tab-cursos ul');
    cursosList.innerHTML = '';
    cursos.forEach(curso => {
      const li = document.createElement('li');
      li.className = 'border rounded-lg p-4 hover:shadow-md';
      li.innerHTML = `<h3 class="text-xl font-semibold">${curso.nombre}</h3><p class="text-gray-600">${curso.descripcion}</p>`;
      cursosList.appendChild(li);
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    fetchCategorias();
  });
</script>
{% endblock %}
